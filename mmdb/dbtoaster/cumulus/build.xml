<project name="Cumulus" default="main" basedir=".">
  <property name="java.src"   location="src/java" />
  <property name="ruby.src"   location="src/ruby" />
  <property name="build" location="build" />
  <property name="bin"   location="bin" />
  <property name="jar"   location="${bin}/cumulus.jar" />
  <property file="local.properties" />
  
  <path id="classpath">
    <pathelement path="${jruby.home}/lib/jruby.jar" />
    <pathelement path="lib/je.jar" />
  </path>
  
  <target name="init">
    <mkdir dir="${build}" />
    <mkdir dir="${bin}" />
    <pathconvert refid="classpath" property="compile.classpath" />
    <property name="run.classpath" value="${compile.classpath}:${jar}" />
    <exec executable="src/tools/make_launchers.sh">
      <arg value="${run.classpath}" />
    </exec>
    
  </target>
  
  <target name="main" depends="init">
    <javac srcdir="${java.src}" destdir="${build}" classpathref="classpath" />
    <jar destfile="${jar}">
      <fileset dir="${build}" />
      <fileset dir="${ruby.src}" />
    </jar>
  </target>
  
  <target name="clean">
    <delete dir="${build}" />
    <delete dir="${bin}" />
  </target>
</project>